Starting training job...
Using dataset at: /scratch/ml8347/3dgs/input/1
Output will be saved to: /scratch/ml8347/3dgs/output/2
Overlay: /scratch/ml8347/MRI/scoreMRI/env/overlay-25GB-500K.ext3
Singularity image: /scratch/ml8347/MRI/base_env/cuda11.8.86-cudnn8.7-devel-ubuntu22.04.2.sif
Using PyTorch native CUDA operations (custom kernels disabled)
Using PyTorch native operations for upfirdn2d (custom kernels disabled)
============================================================
ğŸš€ Starting SENSE MRI Reconstruction Pipeline
============================================================
Initializing...
ğŸ”§ Using device: cuda:0
â±ï¸  Configuration setup: 0.034 seconds

ğŸ“ Loading data from: /scratch/ml8347/MRI/train/train_dataset/compare/file1000060.h5
Loaded slice 16/33 from /scratch/ml8347/MRI/train/train_dataset/compare/file1000060.h5
K-space shape: (15, 640, 372)
Final image shape: torch.Size([1, 15, 320, 320])
â±ï¸  Data loading & preprocessing: 1.406 seconds
â±ï¸  Mask creation: 0.491 seconds

ğŸ§  Loading model checkpoint: /scratch/ml8347/MRI/train/score/workdir3/fastmri_multicoil_knee_320/checkpoints/checkpoint_50.pth
loaded checkpoint dir from /scratch/ml8347/MRI/train/score/workdir3/fastmri_multicoil_knee_320/checkpoints/checkpoint_50.pth
â±ï¸  Model loading & setup: 5.112 seconds
â±ï¸  Directory setup: 0.004 seconds
â±ï¸  K-space operations: 0.341 seconds

ğŸ§² Estimating sensitivity maps...
   Sensitivity maps shape: torch.Size([1, 15, 320, 320])
â±ï¸  Sensitivity estimation: 2.452 seconds

ğŸ”„ Setting up SENSE inference pipeline...
â±ï¸  SENSE Setup time: 0.0000 seconds
â±ï¸  Inference setup: 0.000 seconds

ğŸ¯ Beginning SENSE inference with 500 steps...
   This is ~15x faster than per-coil processing!

ğŸ”„ Starting SENSE PC Sampler with 500 steps
   Working with SINGLE combined image (not 15 coils separately)
â±ï¸  Initial sampling: 0.0896 seconds
   x shape: torch.Size([1, 1, 320, 320]) (single combined image)
  Step 100: 0.756s | Pred: 0.3871s | Corr: 0.3752s | DC: 0.0010s
  Step 200: 0.759s | Pred: 0.3832s | Corr: 0.3759s | DC: 0.0010s
  Step 300: 0.761s | Pred: 0.3822s | Corr: 0.3767s | DC: 0.0010s
  Step 400: 0.763s | Pred: 0.3819s | Corr: 0.3772s | DC: 0.0010s

ğŸ“Š SENSE PC SAMPLER TIMING SUMMARY
==================================================
Total predictor time:     190.846s ( 50.1%)
Total corrector time:     188.750s ( 49.6%)
Total DC time:              1.039s (  0.3%)
Initial sampling:           0.090s (  0.0%)
--------------------------------------------------
TOTAL SAMPLER TIME:       380.863s
Average per step:           0.762s
Model calls per step:    2 (vs 30 for per-coil)
Speedup vs per-coil:     ~15x
==================================================
â±ï¸  Main reconstruction: 380.863 seconds
â±ï¸  Post-processing: 0.071 seconds
â±ï¸  Saving results: 0.685 seconds

============================================================
ğŸ“Š TIMING SUMMARY
============================================================
Configuration setup:        0.034s (  0.0%)
Data loading & prep:        1.406s (  0.4%)
Mask creation:              0.491s (  0.1%)
Model loading & setup:      5.112s (  1.3%)
Directory setup:            0.004s (  0.0%)
K-space operations:         0.341s (  0.1%)
Sensitivity estimation:     2.452s (  0.6%)
Inference setup:            0.000s (  0.0%)
Main reconstruction:      380.863s ( 97.3%)
Post-processing:            0.071s (  0.0%)
Saving results:             0.685s (  0.2%)
------------------------------------------------------------
TOTAL TIME:               391.487s
============================================================

âœ… SENSE Reconstruction completed!
ğŸ“ˆ MSE: 0.016657
ğŸ“ˆ PSNR: 20.83 dB
ğŸ’¾ Results saved to: /scratch/ml8347/MRI/train/compare/outputs_equi_acc4/multi-coil/SENSE

ğŸš€ SENSE speedup: ~15x faster than per-coil processing!
============================================================
ğŸš€ Starting SENSE MRI Reconstruction Pipeline
============================================================
Initializing...
ğŸ”§ Using device: cuda:0
â±ï¸  Configuration setup: 0.000 seconds

ğŸ“ Loading data from: /scratch/ml8347/MRI/train/train_dataset/compare/file1000089.h5
Loaded slice 19/39 from /scratch/ml8347/MRI/train/train_dataset/compare/file1000089.h5
K-space shape: (15, 640, 368)
Final image shape: torch.Size([1, 15, 320, 320])
â±ï¸  Data loading & preprocessing: 0.823 seconds
â±ï¸  Mask creation: 0.001 seconds

ğŸ§  Loading model checkpoint: /scratch/ml8347/MRI/train/score/workdir3/fastmri_multicoil_knee_320/checkpoints/checkpoint_50.pth
loaded checkpoint dir from /scratch/ml8347/MRI/train/score/workdir3/fastmri_multicoil_knee_320/checkpoints/checkpoint_50.pth
â±ï¸  Model loading & setup: 3.578 seconds
â±ï¸  Directory setup: 0.000 seconds
â±ï¸  K-space operations: 0.001 seconds

ğŸ§² Estimating sensitivity maps...
   Sensitivity maps shape: torch.Size([1, 15, 320, 320])
â±ï¸  Sensitivity estimation: 0.003 seconds

ğŸ”„ Setting up SENSE inference pipeline...
â±ï¸  SENSE Setup time: 0.0000 seconds
â±ï¸  Inference setup: 0.000 seconds

ğŸ¯ Beginning SENSE inference with 500 steps...
   This is ~15x faster than per-coil processing!

ğŸ”„ Starting SENSE PC Sampler with 500 steps
   Working with SINGLE combined image (not 15 coils separately)
â±ï¸  Initial sampling: 0.0003 seconds
   x shape: torch.Size([1, 1, 320, 320]) (single combined image)
  Step 100: 0.762s | Pred: 0.3804s | Corr: 0.3784s | DC: 0.0010s
  Step 200: 0.761s | Pred: 0.3807s | Corr: 0.3787s | DC: 0.0010s
  Step 300: 0.762s | Pred: 0.3808s | Corr: 0.3787s | DC: 0.0010s
  Step 400: 0.761s | Pred: 0.3809s | Corr: 0.3788s | DC: 0.0010s

ğŸ“Š SENSE PC SAMPLER TIMING SUMMARY
==================================================
Total predictor time:     190.450s ( 50.0%)
Total corrector time:     189.405s ( 49.7%)
Total DC time:              1.036s (  0.3%)
Initial sampling:           0.000s (  0.0%)
--------------------------------------------------
TOTAL SAMPLER TIME:       380.997s
Average per step:           0.762s
Model calls per step:    2 (vs 30 for per-coil)
Speedup vs per-coil:     ~15x
==================================================
â±ï¸  Main reconstruction: 380.997 seconds
â±ï¸  Post-processing: 0.072 seconds
â±ï¸  Saving results: 0.459 seconds

============================================================
ğŸ“Š TIMING SUMMARY
============================================================
Configuration setup:        0.000s (  0.0%)
Data loading & prep:        0.823s (  0.2%)
Mask creation:              0.001s (  0.0%)
Model loading & setup:      3.578s (  0.9%)
Directory setup:            0.000s (  0.0%)
K-space operations:         0.001s (  0.0%)
Sensitivity estimation:     0.003s (  0.0%)
Inference setup:            0.000s (  0.0%)
Main reconstruction:      380.997s ( 98.7%)
Post-processing:            0.072s (  0.0%)
Saving results:             0.459s (  0.1%)
------------------------------------------------------------
TOTAL TIME:               385.935s
============================================================

âœ… SENSE Reconstruction completed!
ğŸ“ˆ MSE: 0.002814
ğŸ“ˆ PSNR: 28.57 dB
ğŸ’¾ Results saved to: /scratch/ml8347/MRI/train/compare/outputs_equi_acc4/multi-coil/SENSE

ğŸš€ SENSE speedup: ~15x faster than per-coil processing!
============================================================
ğŸš€ Starting SENSE MRI Reconstruction Pipeline
============================================================
Initializing...
ğŸ”§ Using device: cuda:0
â±ï¸  Configuration setup: 0.000 seconds

ğŸ“ Loading data from: /scratch/ml8347/MRI/train/train_dataset/compare/file1000094.h5
Loaded slice 16/33 from /scratch/ml8347/MRI/train/train_dataset/compare/file1000094.h5
K-space shape: (15, 640, 368)
Final image shape: torch.Size([1, 15, 320, 320])
â±ï¸  Data loading & preprocessing: 0.821 seconds
â±ï¸  Mask creation: 0.000 seconds

ğŸ§  Loading model checkpoint: /scratch/ml8347/MRI/train/score/workdir3/fastmri_multicoil_knee_320/checkpoints/checkpoint_50.pth
loaded checkpoint dir from /scratch/ml8347/MRI/train/score/workdir3/fastmri_multicoil_knee_320/checkpoints/checkpoint_50.pth
â±ï¸  Model loading & setup: 3.500 seconds
â±ï¸  Directory setup: 0.000 seconds
â±ï¸  K-space operations: 0.001 seconds

ğŸ§² Estimating sensitivity maps...
   Sensitivity maps shape: torch.Size([1, 15, 320, 320])
â±ï¸  Sensitivity estimation: 0.003 seconds

ğŸ”„ Setting up SENSE inference pipeline...
â±ï¸  SENSE Setup time: 0.0000 seconds
â±ï¸  Inference setup: 0.000 seconds

ğŸ¯ Beginning SENSE inference with 500 steps...
   This is ~15x faster than per-coil processing!

ğŸ”„ Starting SENSE PC Sampler with 500 steps
   Working with SINGLE combined image (not 15 coils separately)
â±ï¸  Initial sampling: 0.0003 seconds
   x shape: torch.Size([1, 1, 320, 320]) (single combined image)
  Step 100: 0.763s | Pred: 0.3806s | Corr: 0.3786s | DC: 0.0010s
  Step 200: 0.763s | Pred: 0.3809s | Corr: 0.3788s | DC: 0.0010s
  Step 300: 0.763s | Pred: 0.3810s | Corr: 0.3789s | DC: 0.0010s
  Step 400: 0.762s | Pred: 0.3810s | Corr: 0.3789s | DC: 0.0010s

ğŸ“Š SENSE PC SAMPLER TIMING SUMMARY
==================================================
Total predictor time:     190.535s ( 50.0%)
Total corrector time:     189.461s ( 49.7%)
Total DC time:              1.036s (  0.3%)
Initial sampling:           0.000s (  0.0%)
--------------------------------------------------
TOTAL SAMPLER TIME:       381.135s
Average per step:           0.762s
Model calls per step:    2 (vs 30 for per-coil)
Speedup vs per-coil:     ~15x
==================================================
â±ï¸  Main reconstruction: 381.135 seconds
â±ï¸  Post-processing: 0.072 seconds
â±ï¸  Saving results: 0.481 seconds

============================================================
ğŸ“Š TIMING SUMMARY
============================================================
Configuration setup:        0.000s (  0.0%)
Data loading & prep:        0.821s (  0.2%)
Mask creation:              0.000s (  0.0%)
Model loading & setup:      3.500s (  0.9%)
Directory setup:            0.000s (  0.0%)
K-space operations:         0.001s (  0.0%)
Sensitivity estimation:     0.003s (  0.0%)
Inference setup:            0.000s (  0.0%)
Main reconstruction:      381.135s ( 98.7%)
Post-processing:            0.072s (  0.0%)
Saving results:             0.481s (  0.1%)
------------------------------------------------------------
TOTAL TIME:               386.013s
============================================================

âœ… SENSE Reconstruction completed!
ğŸ“ˆ MSE: 0.001092
ğŸ“ˆ PSNR: 30.57 dB
ğŸ’¾ Results saved to: /scratch/ml8347/MRI/train/compare/outputs_equi_acc4/multi-coil/SENSE

ğŸš€ SENSE speedup: ~15x faster than per-coil processing!
============================================================
ğŸš€ Starting SENSE MRI Reconstruction Pipeline
============================================================
Initializing...
ğŸ”§ Using device: cuda:0
â±ï¸  Configuration setup: 0.000 seconds

ğŸ“ Loading data from: /scratch/ml8347/MRI/train/train_dataset/compare/file1000311.h5
Loaded slice 15/30 from /scratch/ml8347/MRI/train/train_dataset/compare/file1000311.h5
K-space shape: (15, 640, 322)
Final image shape: torch.Size([1, 15, 320, 320])
â±ï¸  Data loading & preprocessing: 0.623 seconds
â±ï¸  Mask creation: 0.000 seconds

ğŸ§  Loading model checkpoint: /scratch/ml8347/MRI/train/score/workdir3/fastmri_multicoil_knee_320/checkpoints/checkpoint_50.pth
loaded checkpoint dir from /scratch/ml8347/MRI/train/score/workdir3/fastmri_multicoil_knee_320/checkpoints/checkpoint_50.pth
â±ï¸  Model loading & setup: 3.250 seconds
â±ï¸  Directory setup: 0.000 seconds
â±ï¸  K-space operations: 0.001 seconds

ğŸ§² Estimating sensitivity maps...
   Sensitivity maps shape: torch.Size([1, 15, 320, 320])
â±ï¸  Sensitivity estimation: 0.003 seconds

ğŸ”„ Setting up SENSE inference pipeline...
â±ï¸  SENSE Setup time: 0.0000 seconds
â±ï¸  Inference setup: 0.000 seconds

ğŸ¯ Beginning SENSE inference with 500 steps...
   This is ~15x faster than per-coil processing!

ğŸ”„ Starting SENSE PC Sampler with 500 steps
   Working with SINGLE combined image (not 15 coils separately)
â±ï¸  Initial sampling: 0.0003 seconds
   x shape: torch.Size([1, 1, 320, 320]) (single combined image)
  Step 100: 0.761s | Pred: 0.3805s | Corr: 0.3788s | DC: 0.0010s
  Step 200: 0.762s | Pred: 0.3808s | Corr: 0.3789s | DC: 0.0010s
  Step 300: 0.763s | Pred: 0.3810s | Corr: 0.3789s | DC: 0.0010s
  Step 400: 0.760s | Pred: 0.3810s | Corr: 0.3790s | DC: 0.0010s

ğŸ“Š SENSE PC SAMPLER TIMING SUMMARY
==================================================
Total predictor time:     190.519s ( 50.0%)
Total corrector time:     189.477s ( 49.7%)
Total DC time:              1.038s (  0.3%)
Initial sampling:           0.000s (  0.0%)
--------------------------------------------------
TOTAL SAMPLER TIME:       381.139s
Average per step:           0.762s
Model calls per step:    2 (vs 30 for per-coil)
Speedup vs per-coil:     ~15x
==================================================
â±ï¸  Main reconstruction: 381.139 seconds
â±ï¸  Post-processing: 0.071 seconds
â±ï¸  Saving results: 0.525 seconds

============================================================
ğŸ“Š TIMING SUMMARY
============================================================
Configuration setup:        0.000s (  0.0%)
Data loading & prep:        0.623s (  0.2%)
Mask creation:              0.000s (  0.0%)
Model loading & setup:      3.250s (  0.8%)
Directory setup:            0.000s (  0.0%)
K-space operations:         0.001s (  0.0%)
Sensitivity estimation:     0.003s (  0.0%)
Inference setup:            0.000s (  0.0%)
Main reconstruction:      381.139s ( 98.8%)
Post-processing:            0.071s (  0.0%)
Saving results:             0.525s (  0.1%)
------------------------------------------------------------
TOTAL TIME:               385.615s
============================================================

âœ… SENSE Reconstruction completed!
ğŸ“ˆ MSE: 0.015927
ğŸ“ˆ PSNR: 20.97 dB
ğŸ’¾ Results saved to: /scratch/ml8347/MRI/train/compare/outputs_equi_acc4/multi-coil/SENSE

ğŸš€ SENSE speedup: ~15x faster than per-coil processing!
============================================================
ğŸš€ Starting SENSE MRI Reconstruction Pipeline
============================================================
Initializing...
ğŸ”§ Using device: cuda:0
â±ï¸  Configuration setup: 0.000 seconds

ğŸ“ Loading data from: /scratch/ml8347/MRI/train/train_dataset/compare/file1000331.h5
Loaded slice 17/34 from /scratch/ml8347/MRI/train/train_dataset/compare/file1000331.h5
K-space shape: (15, 640, 368)
Final image shape: torch.Size([1, 15, 320, 320])
â±ï¸  Data loading & preprocessing: 0.914 seconds
â±ï¸  Mask creation: 0.000 seconds

ğŸ§  Loading model checkpoint: /scratch/ml8347/MRI/train/score/workdir3/fastmri_multicoil_knee_320/checkpoints/checkpoint_50.pth
loaded checkpoint dir from /scratch/ml8347/MRI/train/score/workdir3/fastmri_multicoil_knee_320/checkpoints/checkpoint_50.pth
â±ï¸  Model loading & setup: 2.926 seconds
â±ï¸  Directory setup: 0.000 seconds
â±ï¸  K-space operations: 0.001 seconds

ğŸ§² Estimating sensitivity maps...
   Sensitivity maps shape: torch.Size([1, 15, 320, 320])
â±ï¸  Sensitivity estimation: 0.003 seconds

ğŸ”„ Setting up SENSE inference pipeline...
â±ï¸  SENSE Setup time: 0.0000 seconds
â±ï¸  Inference setup: 0.000 seconds

ğŸ¯ Beginning SENSE inference with 500 steps...
   This is ~15x faster than per-coil processing!

ğŸ”„ Starting SENSE PC Sampler with 500 steps
   Working with SINGLE combined image (not 15 coils separately)
â±ï¸  Initial sampling: 0.0003 seconds
   x shape: torch.Size([1, 1, 320, 320]) (single combined image)
  Step 100: 0.762s | Pred: 0.3804s | Corr: 0.3787s | DC: 0.0010s
  Step 200: 0.763s | Pred: 0.3808s | Corr: 0.3788s | DC: 0.0010s
  Step 300: 0.762s | Pred: 0.3809s | Corr: 0.3789s | DC: 0.0010s
  Step 400: 0.763s | Pred: 0.3810s | Corr: 0.3789s | DC: 0.0010s

ğŸ“Š SENSE PC SAMPLER TIMING SUMMARY
==================================================
Total predictor time:     190.489s ( 50.0%)
Total corrector time:     189.464s ( 49.7%)
Total DC time:              1.037s (  0.3%)
Initial sampling:           0.000s (  0.0%)
--------------------------------------------------
TOTAL SAMPLER TIME:       381.095s
Average per step:           0.762s
Model calls per step:    2 (vs 30 for per-coil)
Speedup vs per-coil:     ~15x
==================================================
â±ï¸  Main reconstruction: 381.095 seconds
â±ï¸  Post-processing: 0.072 seconds
â±ï¸  Saving results: 0.478 seconds

============================================================
ğŸ“Š TIMING SUMMARY
============================================================
Configuration setup:        0.000s (  0.0%)
Data loading & prep:        0.914s (  0.2%)
Mask creation:              0.000s (  0.0%)
Model loading & setup:      2.926s (  0.8%)
Directory setup:            0.000s (  0.0%)
K-space operations:         0.001s (  0.0%)
Sensitivity estimation:     0.003s (  0.0%)
Inference setup:            0.000s (  0.0%)
Main reconstruction:      381.095s ( 98.9%)
Post-processing:            0.072s (  0.0%)
Saving results:             0.478s (  0.1%)
------------------------------------------------------------
TOTAL TIME:               385.490s
============================================================

âœ… SENSE Reconstruction completed!
ğŸ“ˆ MSE: 0.006545
ğŸ“ˆ PSNR: 23.77 dB
ğŸ’¾ Results saved to: /scratch/ml8347/MRI/train/compare/outputs_equi_acc4/multi-coil/SENSE

ğŸš€ SENSE speedup: ~15x faster than per-coil processing!
============================================================
ğŸš€ Starting Parallel SSOS MRI Reconstruction Pipeline
============================================================
Initializing...
ğŸ”§ Using device: cuda:0
â±ï¸  Configuration setup: 0.000 seconds

ğŸ“ Loading data from: /scratch/ml8347/MRI/train/train_dataset/compare/file1000060.h5
Loaded slice 16/33 from /scratch/ml8347/MRI/train/train_dataset/compare/file1000060.h5
K-space shape: (15, 640, 372)
Final image shape: torch.Size([1, 15, 320, 320])
â±ï¸  Data loading & preprocessing: 0.771 seconds
â±ï¸  Mask creation: 0.001 seconds

ğŸ§  Loading model checkpoint: /scratch/ml8347/MRI/train/score/workdir3/fastmri_multicoil_knee_320/checkpoints/checkpoint_50.pth
loaded checkpoint dir from /scratch/ml8347/MRI/train/score/workdir3/fastmri_multicoil_knee_320/checkpoints/checkpoint_50.pth
â±ï¸  Model loading & setup: 2.172 seconds
â±ï¸  Directory setup: 0.002 seconds

ğŸ”„ Setting up Parallel SSOS inference pipeline...
   ğŸš€ Using PARALLEL SSOS (all coils processed simultaneously)
â±ï¸  Parallel SSOS Setup time: 0.0000 seconds
â±ï¸  Inference setup: 0.000 seconds
â±ï¸  K-space operations: 0.001 seconds

ğŸ¯ Beginning inference with 500 steps...

ğŸ”„ Starting Parallel SSOS PC Sampler with 500 steps, 15 coils
   ğŸš€ Processing ALL coils simultaneously (not sequentially)
â±ï¸  Initial sampling: 0.0237 seconds
